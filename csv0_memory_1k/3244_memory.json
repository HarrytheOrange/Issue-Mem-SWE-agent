{
    "search_index": {
        "description_for_embedding": "Strengthened default NGINX TLS configuration by removing medium-strength 3DES-based ciphers from ssl_ciphers, keeping only strong AES-based suites. Affects legacy clients (e.g., IE on Windows XP) but improves default security posture.",
        "keywords": [
            "nginx",
            "TLS",
            "SSL",
            "ssl_ciphers",
            "cipher suites",
            "3DES",
            "DES-CBC3-SHA",
            "medium-strength ciphers",
            "strong defaults",
            "browser compatibility",
            "IE on XP",
            "security hardening",
            "configuration change"
        ]
    },
    "agent_memory": {
        "episodic_memory": "In this incident, the project’s default NGINX configuration was allowing medium-strength TLS cipher suites, including 3DES-based options such as ECDHE-RSA-DES-CBC3-SHA and EDH-RSA-DES-CBC3-SHA. These ciphers are no longer considered strong and can weaken the security posture of deployed instances that rely on the default configuration. The issue was raised to ensure the product ships with secure defaults. The patch modifies conf/nginx/st2.conf by editing the ssl_ciphers directive: the two DES-CBC3-SHA cipher suites were removed from the colon-separated list. All remaining suites are AES-based and considered strong at the time of the change. Discussion concluded that the primary compatibility impact would be legacy browsers (notably Internet Explorer on Windows XP), which would lose TLS connectivity, but this was deemed acceptable. Users who require older cipher support can still manually re-enable them in their own NGINX configuration. The net effect is stronger out-of-the-box TLS settings with a minor loss of compatibility for obsolete clients.",
        "semantic_memory": "Security-sensitive applications should ship with strong TLS cipher suites by default, even at the cost of dropping support for very old clients. Medium-strength or legacy ciphers (such as 3DES/Triple DES) may still technically work but are no longer recommended due to cryptographic weaknesses and reduced effective security (e.g., susceptibility to attacks like SWEET32). Default configurations should focus on modern, secure suites: ECDHE/DHE key exchange, AES (preferably GCM) encryption, and strong hashes, while excluding NULL, EXPORT, RC4, MD5, and DES/3DES. Maintaining a strong default cipher list leaves room for advanced users to manually relax constraints if they have a specific legacy requirement, but avoids insecure deployments by users who simply trust the defaults. When making such changes, it’s important to consider and document client compatibility impacts, especially around older operating systems and browsers, using compatibility references or tools that list supported cipher suites for common clients.",
        "procedural_memory": [
            "When hardening TLS/SSL configuration (e.g., in NGINX), first inventory the currently enabled cipher suites and identify any medium- or weak-strength ciphers like 3DES, RC4, NULL, EXPORT, or MD5-based suites.",
            "Step 1: Locate the TLS configuration file for your web server (for NGINX, typically /etc/nginx/nginx.conf or an included file such as conf/nginx/st2.conf) and find the ssl_ciphers directive.",
            "Step 2: Copy or list the current ssl_ciphers string and analyze it using documentation or online references (e.g., Mozilla SSL Configuration Generator, cipher suite lists, or SSL Labs docs) to identify legacy or weak ciphers (e.g., DES-CBC3-SHA, ECDHE-RSA-DES-CBC3-SHA, EDH-RSA-DES-CBC3-SHA).",
            "Step 3: Determine the minimum acceptable compatibility level for your users (e.g., do you still need to support IE on Windows XP or other obsolete clients?). Use compatibility tables or tools (SSL Labs client test pages, vendor docs) to see which cipher suites those clients require.",
            "Step 4: Remove weak or medium-strength cipher suites from the ssl_ciphers list, keeping only strong, modern suites (ECDHE/DHE key exchange; AES or AES-GCM; SHA2-based MACs). Ensure you also include exclusions such as !aNULL:!eNULL:!EXPORT:!DES:!MD5:!PSK:!RC4 when appropriate.",
            "Step 5: Keep ssl_prefer_server_ciphers on (or the equivalent in your server) so that the server’s cipher priority order is enforced, ensuring the strongest supported cipher is chosen rather than the client’s preference.",
            "Step 6: Test the configuration locally: run nginx -t (or the server’s config test command) to validate syntax, then reload/restart the service.",
            "Step 7: Use an external TLS analysis tool (e.g., Qualys SSL Labs, testssl.sh, or similar) against your endpoint to verify that only strong cipher suites are offered and that medium/weak ciphers are no longer accepted.",
            "Step 8: Validate client compatibility in a staging or testing environment with representative browsers and systems. Specifically test any known legacy clients you still support.",
            "Step 9: Document the change and its impact: note which cipher suites were removed, why (security hardening, deprecation), and which client platforms may be affected. Provide guidance for users who absolutely must re-enable legacy ciphers, including where and how to override the default configuration.",
            "Step 10: Periodically review and update your TLS configuration as best practices evolve, removing newly deprecated ciphers and enabling new recommended ones, ensuring the default configuration remains secure over time."
        ]
    }
}